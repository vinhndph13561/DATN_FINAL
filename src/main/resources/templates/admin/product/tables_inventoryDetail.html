<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" th:replace="~{/admin/index :: dynamic(~{::main})}">

<body>
	<main>
		<h1 class="h3 mb-2 text-gray-800">Nhập hàng lên gian hàng</h1>
		<div class="alert alert-success" th:text="${insertSuccess}" th:if="${insertSuccess != null}"></div>
		<div class="alert alert-success" th:text="${updateSuccess}" th:if="${updateSuccess != null}"></div>
		<div class="alert alert-danger" th:text="${updateFailed}" th:if="${updateFailed != null}"></div>
		<div class="alert alert-danger" th:text="${insertFailed}" th:if="${insertFailed != null}"></div>
		<div class="card shadow mb-4">
			
			<h5 style="margin-left:30px;margin-top:20px;">Chú thích : </h5>
			<p style="margin-left:30px;">--Trường hợp sản phẩm đã được bày bán trên gian hàng, bạn có thể thay đổi giá tiền bằng cách nhập vào 'Nhập giá bán (vnd)', Nếu không nhập sẽ lấy theo giá cũ </p>
			<p style="margin-left:30px;">--Trường hợp sản phẩm chưa được bày bán trên gian hàng, Hãy nhập giá vào ô 'Nhập giá bán (vnd)', Nếu không nhập sẽ lấy theo giá của từng size khác nhau, công thức tính: </p>
			<p style="margin-left:30px;"> Size XXS, XS : giá gốc * 1.3
			<br>
			<p style="margin-left:30px;"> Size S , M : ( giá gốc * 1.3) + 5000
			<br>
			<p style="margin-left:30px;"> Size L, XL : (giá gốc * 1.3) + 10000
			<br>
			<p style="margin-left:30px;"> Size XXL, XXXL : (giá gốc * 1.3) + 15000
			<br>
			<p style="margin-left:30px;"> (Size XL : giá gốc + 20000) * 1.3
			<br>
			<p style="margin-left:30px;"> (Size XXL : giá gốc + 25000) * 1.3
			 </p>

			<div class="card-body">
				<div class="table-responsive">
				<form th:action = "@{/addProduct}" method = "POST">
					<table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
						<thead>
							<tr>
								<th width="25px;">
								<input type="checkbox" id="chkAll" onclick="selectAll()">
								</th>
								<th width="75px;">Tên sản phẩm</th>
								<th>Size</th>
								<th>Màu</th>
								<th width="75px;">Số lượng kho</th>
								<th>Ngày tạo</th>
								<th>Ảnh</th>
								<th>Giá gốc (VNĐ)</th>
								<th width="100px;">Giá đang bán(VNĐ)</th>
								<th width="50px;">Nhập số lượng</th>
								<th width="150px;">Nhập giá bán (vnd)</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="listPR : ${inventoryDetail}">
								<td>
									<input type="hidden" th:name="chk2" th:value = "${listPR.inventoryProductDetail.id}">
									<input type="checkbox" th:name="chk[]" th:value = "${listPR.inventoryProductDetail.id}">
								 </td>
								<td th:text="${listPR.inventoryProductDetail.product.name}"></td>
								<td th:text="${listPR.inventoryProductDetail.size}"></td>
								<td th:text="${listPR.inventoryProductDetail.color}"></td>
								<td th:text="${listPR.inventoryProductDetail.quantity}"></td>
								<input type = "hidden" name ="soKho" th:value ="${listPR.inventoryProductDetail.quantity}">
								<td th:text="${#dates.format(listPR.inventoryProductDetail.createDay,'dd-MM-yyyy')}"></td>
								<td>
									<img th:src="@{|/assets/img/${listPR.inventoryProductDetail.thumnail}|}" height="150px" width="150px">
								</td>
								<td th:text="${#numbers.formatInteger(cost,3,'POINT')}"></td>
								<td th:if="${listPR.inventoryProductDetail.price == null}">Chưa có</td>
								<td th:if="${listPR.inventoryProductDetail.price != null}" th:text="${#numbers.formatInteger(listPR.inventoryProductDetail.price,3,'POINT')}"></td>
								<td>
									<input type="number" th:name = "listPD1" id="soNhap" value=0 onblur = "onblurNum()">
								 </td>
								 <td>
								 	<input type="number" th:name = "listPD" value=0>
								 </td>
								 
							</tr>
						</tbody>
					</table>
						<input type = "submit" value= "Nhập hàng" class = "btn btn-primary"  >
					</form>
				</div>
			</div>
		</div>
		<script>
			function showConfirmModalDialog(id, name) {
				$('#name').text(name);
				$('#yesOption').attr('href', '/api/product/delete/' + id);
				$('#confirmationId').modal('show');
			}
			function selectAll() {
			var chkAll = document.getElementById("chkAll");
			var chk = document.getElementsByName("chk[]");
			if (chkAll.checked == true) {
				for (var i = 0; i < chk.length; i++) {
					chk[i].checked = true;
				}
			} else {
				for (var i = 0; i < chk.length; i++) {
					chk[i].checked = false;
				}
			}
			document.getElementsByClassName("chk")
		}
			
			function setPrice() {
			var setPR = document.getElementsByName("chk1");
				var inp = document.getElementsByName("listPD");
							if (setPR[i].checked == true) {
								alert(i);
							}
			}
			
			function onblurNum() {
			var soKho = document.getElementsByName("soKho");
			var soNhap = document.getElementsByName("listPD1");
			for (var i=0; i< soKho.length; i++) {
				if (parseInt(soKho[i].value) < parseInt(soNhap[i].value)) {
					alert("Số lượng nhập không được lớn hơn số lượng trong kho");
					return;
				}
			}
			
			}
			
			
		</script>
		<!-- Logout Modal-->
		<div class="modal fade" id="confirmationId" tabindex="-1" role="dialog" aria-labelledby="modelTitleId"
			aria-hidden="true">
			<div class="modal-dialog" role="document">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="exampleModalLabel">Thay đổi trạng thái sản phẩm</h5>
						<button class="close" type="button" data-dismiss="modal" aria-label="Close">
							<span aria-hidden="true">×</span>
						</button>
					</div>
					<div class="modal-body">Bạn có muốn thay đổi trạng thái sản phẩm <span id="name"></span>
						không ?</div>
					<div class="modal-footer">
						<button class="btn btn-secondary" type="button" data-dismiss="modal">No</button>
						<a id="yesOption" type="button" class="btn btn-danger">Yes</a>
					</div>
				</div>
			</div>
		</div>
	</main>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.5/dist/umd/popper.min.js" integrity="sha384-Xe+8cL9oJa6tN/veChSP7q+mnSPaj5Bcu9mPX5F5xIGE0DVittaqT5lorf0EI7Vk" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.min.js" integrity="sha384-kjU+l4N0Yf4ZOJErLsIcvOU2qSb74wXpOhqTvwVx3OElZRweTnQ6d31fXEoRD1Jy" crossorigin="anonymous"></script>

	
	
</body>

</html>